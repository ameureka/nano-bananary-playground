# ğŸš€ éƒ¨ç½²æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»å¦‚ä½•å°†é¦™è•‰PSä¹å›­éƒ¨ç½²åˆ°å„ç§å¹³å°ã€‚

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
# å®‰è£…ä¾èµ–
npm install

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

æ„å»ºå®Œæˆåï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆ `dist` æ–‡ä»¶å¤¹ï¼ŒåŒ…å«æ‰€æœ‰é™æ€æ–‡ä»¶ã€‚

### 2. æœ¬åœ°é¢„è§ˆ

```bash
# é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬
npm run preview
```

è®¿é—® http://localhost:4173 æŸ¥çœ‹ç”Ÿäº§ç‰ˆæœ¬æ•ˆæœã€‚

### 3. ç¯å¢ƒå˜é‡é…ç½®

ç¡®ä¿åœ¨éƒ¨ç½²å¹³å°é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```env
GEMINI_API_KEY=ä½ çš„APIå¯†é’¥
```

> âš ï¸ **é‡è¦**ï¼šä¸è¦å°† API å¯†é’¥æäº¤åˆ°ä»£ç ä»“åº“ï¼

---

## ğŸŒ Vercel éƒ¨ç½²ï¼ˆæ¨èï¼‰

Vercel æ˜¯æœ€ç®€å•çš„éƒ¨ç½²æ–¹å¼ï¼Œæ”¯æŒè‡ªåŠ¨éƒ¨ç½²å’Œ HTTPSã€‚

### æ–¹æ³• 1ï¼šé€šè¿‡ GitHub è‡ªåŠ¨éƒ¨ç½²

1. **è¿æ¥ GitHub ä»“åº“**
   - è®¿é—® [Vercel](https://vercel.com/)
   - ç‚¹å‡» "New Project"
   - é€‰æ‹©ä½ çš„ GitHub ä»“åº“
   - æˆæƒ Vercel è®¿é—®

2. **é…ç½®é¡¹ç›®**
   - Framework Preset: Vite
   - Root Directory: `./`
   - Build Command: `npm run build`
   - Output Directory: `dist`

3. **é…ç½®ç¯å¢ƒå˜é‡**
   - åœ¨ "Environment Variables" éƒ¨åˆ†æ·»åŠ ï¼š
     - Name: `GEMINI_API_KEY`
     - Value: ä½ çš„ API å¯†é’¥
     - Environment: Production

4. **éƒ¨ç½²**
   - ç‚¹å‡» "Deploy"
   - ç­‰å¾…æ„å»ºå®Œæˆï¼ˆé€šå¸¸ 1-2 åˆ†é’Ÿï¼‰
   - è·å¾—éƒ¨ç½² URLï¼ˆå¦‚ `your-app.vercel.app`ï¼‰

5. **è‡ªåŠ¨éƒ¨ç½²**
   - æ¯æ¬¡æ¨é€åˆ° GitHub ä¸»åˆ†æ”¯æ—¶è‡ªåŠ¨éƒ¨ç½²
   - Pull Request ä¼šç”Ÿæˆé¢„è§ˆéƒ¨ç½²

### æ–¹æ³• 2ï¼šé€šè¿‡ Vercel CLI éƒ¨ç½²

```bash
# å®‰è£… Vercel CLI
npm install -g vercel

# ç™»å½•
vercel login

# éƒ¨ç½²
vercel

# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
vercel --prod
```

### è‡ªå®šä¹‰åŸŸå

1. åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­ç‚¹å‡» "Domains"
2. æ·»åŠ ä½ çš„åŸŸå
3. æŒ‰ç…§æç¤ºé…ç½® DNS è®°å½•
4. ç­‰å¾… DNS ç”Ÿæ•ˆï¼ˆé€šå¸¸å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ï¼‰

---

## ğŸ”· Netlify éƒ¨ç½²

Netlify ä¹Ÿæ˜¯ä¸€ä¸ªä¼˜ç§€çš„é™æ€ç½‘ç«™æ‰˜ç®¡å¹³å°ã€‚

### æ–¹æ³• 1ï¼šæ‹–æ‹½éƒ¨ç½²

1. **æ„å»ºé¡¹ç›®**
   ```bash
   npm run build
   ```

2. **ä¸Šä¼ åˆ° Netlify**
   - è®¿é—® [Netlify](https://www.netlify.com/)
   - ç‚¹å‡» "Add new site" â†’ "Deploy manually"
   - æ‹–æ‹½ `dist` æ–‡ä»¶å¤¹åˆ°ä¸Šä¼ åŒºåŸŸ
   - ç­‰å¾…éƒ¨ç½²å®Œæˆ

3. **é…ç½®ç¯å¢ƒå˜é‡**
   - è¿›å…¥ Site settings â†’ Environment variables
   - æ·»åŠ  `GEMINI_API_KEY`

### æ–¹æ³• 2ï¼šé€šè¿‡ GitHub è‡ªåŠ¨éƒ¨ç½²

1. **è¿æ¥ GitHub**
   - ç‚¹å‡» "Add new site" â†’ "Import an existing project"
   - é€‰æ‹© GitHub å¹¶æˆæƒ
   - é€‰æ‹©ä½ çš„ä»“åº“

2. **é…ç½®æ„å»ºè®¾ç½®**
   - Build command: `npm run build`
   - Publish directory: `dist`
   - æ·»åŠ ç¯å¢ƒå˜é‡ `GEMINI_API_KEY`

3. **éƒ¨ç½²**
   - ç‚¹å‡» "Deploy site"
   - æ¯æ¬¡æ¨é€åˆ°ä¸»åˆ†æ”¯è‡ªåŠ¨éƒ¨ç½²

### æ–¹æ³• 3ï¼šé€šè¿‡ Netlify CLI éƒ¨ç½²

```bash
# å®‰è£… Netlify CLI
npm install -g netlify-cli

# ç™»å½•
netlify login

# åˆå§‹åŒ–
netlify init

# éƒ¨ç½²
netlify deploy

# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
netlify deploy --prod
```

---

## ğŸ“„ GitHub Pages éƒ¨ç½²

GitHub Pages æä¾›å…è´¹çš„é™æ€ç½‘ç«™æ‰˜ç®¡ã€‚

### é…ç½®æ­¥éª¤

1. **ä¿®æ”¹ vite.config.ts**

```typescript
// vite.config.ts
export default defineConfig({
  base: '/nano-bananary-playground/',  // ä½ çš„ä»“åº“å
  // ... å…¶ä»–é…ç½®
});
```

2. **æ„å»ºé¡¹ç›®**

```bash
npm run build
```

3. **éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯**

```bash
# å®‰è£… gh-pages
npm install -D gh-pages

# æ·»åŠ éƒ¨ç½²è„šæœ¬åˆ° package.json
{
  "scripts": {
    "deploy": "gh-pages -d dist"
  }
}

# éƒ¨ç½²
npm run deploy
```

4. **é…ç½® GitHub Pages**
   - è¿›å…¥ä»“åº“ Settings â†’ Pages
   - Source: Deploy from a branch
   - Branch: gh-pages / (root)
   - ç‚¹å‡» Save

5. **è®¿é—®ç½‘ç«™**
   - URL: `https://ä½ çš„ç”¨æˆ·å.github.io/ä»“åº“å/`

### æ³¨æ„äº‹é¡¹

- GitHub Pages ä¸æ”¯æŒç¯å¢ƒå˜é‡
- éœ€è¦åœ¨å®¢æˆ·ç«¯ç¡¬ç¼–ç  API å¯†é’¥ï¼ˆä¸æ¨èï¼‰
- æˆ–è€…ä½¿ç”¨åç«¯ä»£ç†ï¼ˆæ¨èï¼‰

---

## ğŸ³ Docker éƒ¨ç½²

ä½¿ç”¨ Docker å¯ä»¥åœ¨ä»»ä½•æ”¯æŒ Docker çš„å¹³å°éƒ¨ç½²ã€‚

### åˆ›å»º Dockerfile

```dockerfile
# Dockerfile
FROM node:18-alpine AS builder

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .
RUN npm run build

FROM nginx:alpine

COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

### åˆ›å»º nginx.conf

```nginx
# nginx.conf
server {
    listen 80;
    server_name _;
    root /usr/share/nginx/html;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # å¯ç”¨ gzip å‹ç¼©
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
}
```

### æ„å»ºå’Œè¿è¡Œ

```bash
# æ„å»ºé•œåƒ
docker build -t banana-ps-playground .

# è¿è¡Œå®¹å™¨
docker run -d -p 80:80 --name banana-ps banana-ps-playground

# æŸ¥çœ‹æ—¥å¿—
docker logs banana-ps

# åœæ­¢å®¹å™¨
docker stop banana-ps

# åˆ é™¤å®¹å™¨
docker rm banana-ps
```

### ä½¿ç”¨ Docker Compose

```yaml
# docker-compose.yml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "80:80"
    restart: unless-stopped
```

```bash
# å¯åŠ¨
docker-compose up -d

# åœæ­¢
docker-compose down
```

---

## ğŸ–¥ï¸ è‡ªå·±çš„æœåŠ¡å™¨éƒ¨ç½²

### ä½¿ç”¨ Nginx

1. **å®‰è£… Nginx**

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install nginx

# CentOS/RHEL
sudo yum install nginx
```

2. **ä¸Šä¼ æ„å»ºæ–‡ä»¶**

```bash
# æœ¬åœ°æ„å»º
npm run build

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp -r dist/* user@server:/var/www/banana-ps/
```

3. **é…ç½® Nginx**

```nginx
# /etc/nginx/sites-available/banana-ps
server {
    listen 80;
    server_name your-domain.com;
    root /var/www/banana-ps;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # å¯ç”¨ gzip
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml;

    # ç¼“å­˜é™æ€èµ„æº
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

4. **å¯ç”¨ç«™ç‚¹**

```bash
# åˆ›å»ºç¬¦å·é“¾æ¥
sudo ln -s /etc/nginx/sites-available/banana-ps /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯ Nginx
sudo systemctl restart nginx
```

5. **é…ç½® HTTPSï¼ˆä½¿ç”¨ Let's Encryptï¼‰**

```bash
# å®‰è£… Certbot
sudo apt install certbot python3-certbot-nginx

# è·å–è¯ä¹¦
sudo certbot --nginx -d your-domain.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

### ä½¿ç”¨ Apache

1. **å®‰è£… Apache**

```bash
sudo apt install apache2
```

2. **é…ç½®è™šæ‹Ÿä¸»æœº**

```apache
# /etc/apache2/sites-available/banana-ps.conf
<VirtualHost *:80>
    ServerName your-domain.com
    DocumentRoot /var/www/banana-ps

    <Directory /var/www/banana-ps>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # é‡å†™è§„åˆ™
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteBase /
        RewriteRule ^index\.html$ - [L]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule . /index.html [L]
    </IfModule>

    ErrorLog ${APACHE_LOG_DIR}/banana-ps-error.log
    CustomLog ${APACHE_LOG_DIR}/banana-ps-access.log combined
</VirtualHost>
```

3. **å¯ç”¨ç«™ç‚¹**

```bash
# å¯ç”¨å¿…è¦çš„æ¨¡å—
sudo a2enmod rewrite

# å¯ç”¨ç«™ç‚¹
sudo a2ensite banana-ps

# é‡å¯ Apache
sudo systemctl restart apache2
```

---

## ğŸ”’ å®‰å…¨é…ç½®

### 1. ä¿æŠ¤ API å¯†é’¥

**æ–¹æ³• 1ï¼šä½¿ç”¨åç«¯ä»£ç†**

åˆ›å»ºä¸€ä¸ªç®€å•çš„ Node.js åç«¯ï¼š

```javascript
// server.js
const express = require('express');
const { GoogleGenAI } = require('@google/genai');

const app = express();
app.use(express.json());

const ai = new GoogleGenAI({ 
  apiKey: process.env.GEMINI_API_KEY 
});

app.post('/api/generate', async (req, res) => {
  try {
    const { prompt, images } = req.body;
    const result = await ai.models.generateContent({
      model: 'gemini-2.5-flash-image',
      contents: { parts: [{ text: prompt }, ...images] },
    });
    res.json(result);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

app.listen(3001, () => {
  console.log('API proxy running on port 3001');
});
```

**æ–¹æ³• 2ï¼šä½¿ç”¨ Serverless Functions**

Vercel Functions ç¤ºä¾‹ï¼š

```typescript
// api/generate.ts
import { GoogleGenAI } from '@google/genai';

export default async function handler(req, res) {
  const ai = new GoogleGenAI({ 
    apiKey: process.env.GEMINI_API_KEY 
  });
  
  const { prompt } = req.body;
  const result = await ai.models.generateContent({
    model: 'gemini-2.5-flash',
    contents: prompt,
  });
  
  res.json(result);
}
```

### 2. é…ç½® CORS

```nginx
# Nginx
add_header Access-Control-Allow-Origin "https://your-domain.com";
add_header Access-Control-Allow-Methods "GET, POST, OPTIONS";
add_header Access-Control-Allow-Headers "Content-Type, Authorization";
```

### 3. é…ç½® CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰

```html
<!-- index.html -->
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; 
               script-src 'self' 'unsafe-inline'; 
               style-src 'self' 'unsafe-inline'; 
               img-src 'self' data: https:; 
               connect-src 'self' https://generativelanguage.googleapis.com;">
```

### 4. é…ç½®é€Ÿç‡é™åˆ¶

```nginx
# Nginx
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;

location /api/ {
    limit_req zone=api burst=20 nodelay;
}
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. å¯ç”¨å‹ç¼©

```nginx
# Nginx
gzip on;
gzip_vary on;
gzip_min_length 1024;
gzip_types text/plain text/css text/xml text/javascript 
           application/x-javascript application/xml+rss 
           application/json application/javascript;
```

### 2. é…ç½®ç¼“å­˜

```nginx
# Nginx
location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}

location ~* \.(html)$ {
    expires -1;
    add_header Cache-Control "no-cache, no-store, must-revalidate";
}
```

### 3. ä½¿ç”¨ CDN

æ¨èçš„ CDN æœåŠ¡ï¼š
- Cloudflareï¼ˆå…è´¹ï¼‰
- AWS CloudFront
- Fastly
- é˜¿é‡Œäº‘ CDN

é…ç½®æ­¥éª¤ï¼š
1. åœ¨ CDN æœåŠ¡å•†åˆ›å»ºåˆ†å‘
2. å°†æºç«™è®¾ç½®ä¸ºä½ çš„æœåŠ¡å™¨
3. æ›´æ–° DNS è®°å½•æŒ‡å‘ CDN
4. é…ç½®ç¼“å­˜è§„åˆ™

---

## ğŸ” ç›‘æ§å’Œæ—¥å¿—

### 1. é…ç½®è®¿é—®æ—¥å¿—

```nginx
# Nginx
access_log /var/log/nginx/banana-ps-access.log combined;
error_log /var/log/nginx/banana-ps-error.log warn;
```

### 2. ä½¿ç”¨åˆ†æå·¥å…·

- Google Analytics
- Plausible Analyticsï¼ˆéšç§å‹å¥½ï¼‰
- Umamiï¼ˆå¼€æºï¼‰

### 3. é”™è¯¯ç›‘æ§

- Sentryï¼ˆæ¨èï¼‰
- Rollbar
- Bugsnag

```typescript
// é›†æˆ Sentry
import * as Sentry from "@sentry/react";

Sentry.init({
  dsn: "your-sentry-dsn",
  environment: "production",
});
```

---

## ğŸ”„ æŒç»­é›†æˆ/æŒç»­éƒ¨ç½² (CI/CD)

### GitHub Actions ç¤ºä¾‹

```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [ main ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        
    - name: Install dependencies
      run: npm ci
      
    - name: Build
      run: npm run build
      env:
        GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        
    - name: Deploy to Vercel
      uses: amondnet/vercel-action@v20
      with:
        vercel-token: ${{ secrets.VERCEL_TOKEN }}
        vercel-org-id: ${{ secrets.ORG_ID }}
        vercel-project-id: ${{ secrets.PROJECT_ID }}
        vercel-args: '--prod'
```

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰è¯·ç¡®è®¤ï¼š

- [ ] ä»£ç å·²æ¨é€åˆ° GitHub
- [ ] ç¯å¢ƒå˜é‡å·²æ­£ç¡®é…ç½®
- [ ] æœ¬åœ°æ„å»ºæˆåŠŸ
- [ ] æœ¬åœ°é¢„è§ˆæ­£å¸¸
- [ ] API å¯†é’¥æœ‰æ•ˆ
- [ ] æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] å“åº”å¼å¸ƒå±€æ­£å¸¸
- [ ] æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•é€šè¿‡

éƒ¨ç½²åè¯·æ£€æŸ¥ï¼š

- [ ] ç½‘ç«™å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] æ‰€æœ‰é¡µé¢åŠ è½½æ­£å¸¸
- [ ] å›¾ç‰‡ç”ŸæˆåŠŸèƒ½æ­£å¸¸
- [ ] AI å¯¹è¯åŠŸèƒ½æ­£å¸¸
- [ ] èµ„äº§åº“åŠŸèƒ½æ­£å¸¸
- [ ] ç§»åŠ¨ç«¯æ˜¾ç¤ºæ­£å¸¸
- [ ] HTTPS è¯ä¹¦æœ‰æ•ˆ
- [ ] æ€§èƒ½æŒ‡æ ‡è‰¯å¥½

---

## ğŸ†˜ å¸¸è§éƒ¨ç½²é—®é¢˜

### é—®é¢˜ 1ï¼šæ„å»ºå¤±è´¥

**é”™è¯¯**ï¼š`npm run build` å¤±è´¥

**è§£å†³**ï¼š
```bash
# æ¸…é™¤ç¼“å­˜
rm -rf node_modules package-lock.json
npm install
npm run build
```

### é—®é¢˜ 2ï¼šç¯å¢ƒå˜é‡ä¸ç”Ÿæ•ˆ

**é”™è¯¯**ï¼šAPI å¯†é’¥æœªå®šä¹‰

**è§£å†³**ï¼š
- æ£€æŸ¥ç¯å¢ƒå˜é‡åç§°æ˜¯å¦æ­£ç¡®
- ç¡®è®¤åœ¨éƒ¨ç½²å¹³å°é…ç½®äº†ç¯å¢ƒå˜é‡
- é‡æ–°éƒ¨ç½²é¡¹ç›®

### é—®é¢˜ 3ï¼šè·¯ç”± 404 é”™è¯¯

**é”™è¯¯**ï¼šåˆ·æ–°é¡µé¢æ˜¾ç¤º 404

**è§£å†³**ï¼š
- é…ç½®æœåŠ¡å™¨é‡å†™è§„åˆ™
- æ‰€æœ‰è·¯ç”±éƒ½åº”è¯¥è¿”å› `index.html`

### é—®é¢˜ 4ï¼šCORS é”™è¯¯

**é”™è¯¯**ï¼šè·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢

**è§£å†³**ï¼š
- é…ç½®æœåŠ¡å™¨ CORS å¤´
- æˆ–ä½¿ç”¨åç«¯ä»£ç†

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2025-10-27

ç¥éƒ¨ç½²é¡ºåˆ©ï¼å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ [å¸¸è§é—®é¢˜æ–‡æ¡£](./å¸¸è§é—®é¢˜.md) æˆ–åœ¨ GitHub æäº¤ Issueã€‚
