# ❓ 常见问题 (FAQ)

本文档收集了用户最常遇到的问题和解决方案。

## 🔑 API 密钥相关

### Q: 如何获取 Gemini API 密钥？

**A:** 
1. 访问 [Google AI Studio](https://aistudio.google.com/apikey)
2. 使用 Google 账号登录
3. 点击 "Create API Key" 按钮
4. 复制生成的密钥（格式：`AIzaSy...`）

### Q: API 密钥配置后不生效？

**A:** 请检查以下几点：
1. 确保 `.env.local` 文件在项目根目录
2. 密钥格式正确：`GEMINI_API_KEY=AIza...`（不要有引号）
3. 重启开发服务器（Ctrl+C 停止，然后 `npm run dev`）
4. 清除浏览器缓存并刷新页面
5. 检查浏览器控制台（F12）是否有错误信息

### Q: API 密钥会被泄露吗？

**A:** 
- `.env.local` 文件已在 `.gitignore` 中，不会被提交到 Git
- 但在浏览器中，密钥会被发送到 Google API
- 建议：
  - 不要在公共场合展示浏览器开发者工具
  - 定期更换 API 密钥
  - 在 Google AI Studio 中设置使用限制

### Q: 免费 API 有什么限制？

**A:** Google Gemini API 免费层限制：
- **每分钟请求数**：15 次
- **每天请求数**：1,500 次
- **每月请求数**：根据模型不同而异

超出限制后会收到 `RESOURCE_EXHAUSTED` 错误。

---

## 🖼️ 图片生成相关

### Q: 图片生成失败怎么办？

**A:** 按以下步骤排查：

1. **检查网络连接**
   - 确保可以访问 Google 服务
   - 尝试访问 https://aistudio.google.com 测试连接

2. **查看错误信息**
   - 按 F12 打开浏览器控制台
   - 查看 Console 标签中的错误详情
   - 常见错误及解决方法见下文

3. **检查输入**
   - 确保图片已正确上传
   - 图片格式支持：PNG、JPEG、WebP
   - 图片大小建议：1-5MB

4. **修改提示词**
   - 某些内容可能触发安全过滤
   - 尝试使用更具体、更中性的描述

5. **使用重试功能**
   - 在设置中增加重试次数
   - 系统会自动重试失败的请求

### Q: 为什么生成的图片有水印？

**A:** 
- 默认情况下，应用会添加水印保护版权
- 水印包括：
  - 隐形水印（LSB 算法嵌入）
  - 可见水印（右下角文字）
- 如何去除：
  - 连续点击应用标题 5 次开启进阶模式
  - 进阶模式下生成的图片不会有水印

### Q: 生成的图片质量不好？

**A:** 提升质量的方法：

1. **使用高质量输入**
   - 上传高分辨率图片
   - 避免模糊或压缩过度的图片

2. **优化提示词**
   - 添加质量关键词：高清、细节丰富、专业摄影等
   - 描述具体的风格和氛围

3. **使用高清增强**
   - 先用"高清增强"效果提升质量
   - 再应用其他艺术效果

4. **批量生成选择**
   - 设置生成数量为 4
   - 从多个变体中选择最好的

### Q: 多图效果如何使用？

**A:** 不同类型的多图效果使用方法：

**网格效果（拍立得合照、极简插画）**：
1. 选择效果后会显示 2x2 网格上传器
2. 点击每个格子上传图片（1-4张）
3. 可以从资产库批量导入
4. 点击生成，AI 会自动组合

**双图效果（姿势迁移、风格模仿等）**：
1. 左侧上传主图（要编辑的图片）
2. 右侧上传参考图（姿势/风格参考）
3. 点击生成

**配色方案（两步处理）**：
1. 左侧上传原图
2. 右侧上传调色板图片
3. 系统会先生成线稿，再应用颜色

---

## 🎬 视频生成相关

### Q: 视频生成需要多长时间？

**A:** 
- 通常需要 **2-5 分钟**
- 系统会显示实时进度提示
- 请耐心等待，不要关闭页面或刷新

### Q: 视频生成失败？

**A:** 可能的原因和解决方法：

1. **提示词不合理**
   - 使用具体、可视化的描述
   - 避免抽象或矛盾的概念

2. **起始图片问题**
   - 确保图片清晰度足够
   - 避免过于复杂的场景

3. **API 配额不足**
   - 视频生成消耗较多配额
   - 检查 Google AI Studio 的配额使用情况

4. **网络超时**
   - 视频生成时间较长，可能超时
   - 尝试使用更稳定的网络连接

### Q: 动态拍立得如何使用？

**A:** 完整流程：

1. **上传照片**
   - 在网格上传器中上传 1-4 张照片

2. **生成静态拍立得**
   - 点击"生成图像"按钮
   - 系统会生成 4 个拍立得风格的图片

3. **选择一张**
   - 点击你最喜欢的一张
   - 图片会显示蓝色边框和对勾

4. **创建视频**
   - 点击"创建视频"按钮
   - 等待 2-5 分钟
   - 查看动态拍立得视频

### Q: 生成的视频如何下载？

**A:** 
1. 视频生成后会自动显示在结果区域
2. 点击视频下方的下载按钮
3. 视频会以 MP4 格式保存到本地
4. 视频也会自动保存到资产库

---

## 💬 AI 对话相关

### Q: AI 对话不理解我的问题？

**A:** 改进对话质量的方法：

1. **提供更多上下文**
   - 描述具体的场景和需求
   - 上传相关的参考图片

2. **分步提问**
   - 将复杂问题拆分为多个简单问题
   - 逐步引导 AI 理解你的意图

3. **使用示例**
   - 提供具体的例子说明你想要什么
   - 参考成功的提示词模板

4. **调整历史长度**
   - 在设置中增加历史长度
   - 让 AI 记住更多上下文

### Q: AI 生成的图片不符合预期？

**A:** 

1. **开启 AI 预处理**
   - 在对话设置中开启"AI 预处理"
   - AI 会自动优化你的提示词

2. **使用创意多样化**
   - 开启"创意多样化"选项
   - 一次生成多个不同风格的图片

3. **提供参考图片**
   - 上传你想要的风格参考
   - 开启"附带图片预处理"

4. **明确描述风格**
   - 添加艺术风格关键词
   - 描述具体的色彩、光线、氛围

### Q: 如何编辑或重新生成消息？

**A:** 

**编辑用户消息**：
1. 点击你发送的消息
2. 消息内容会填充到输入框
3. 修改后重新发送
4. 历史记录会从该消息处截断

**重新生成 AI 回复**：
1. 点击对话页面顶部的"重新生成"按钮
2. AI 会基于最后一条用户消息重新生成回复
3. 之前的 AI 回复会被替换

---

## 📚 资产库相关

### Q: 资产库的图片保存在哪里？

**A:** 
- 图片保存在浏览器的 **localStorage** 中
- 数据存储在本地，不会上传到服务器
- 每个浏览器独立存储，不同浏览器看不到对方的数据

### Q: 资产库的图片会丢失吗？

**A:** 可能丢失的情况：

1. **清除浏览器数据**
   - 清除缓存和 Cookie 会删除 localStorage
   - 建议定期下载重要图片到本地

2. **浏览器隐私模式**
   - 隐私/无痕模式下的数据不会持久化
   - 关闭窗口后数据会丢失

3. **存储空间不足**
   - localStorage 有大小限制（通常 5-10MB）
   - 超出限制后可能无法保存新图片

**建议**：
- 定期批量下载图片到本地
- 重要图片及时备份
- 不要依赖浏览器存储作为唯一备份

### Q: 如何批量下载图片？

**A:** 
1. 进入资产库页面
2. 点击"全选"按钮（或手动选择多张）
3. 点击顶部的"下载"按钮
4. 图片会打包为 ZIP 文件下载

> 注意：批量下载功能目前可能还在开发中，请查看应用实际功能。

### Q: 如何将资产库的图片用于编辑？

**A:** 
1. 在资产库中找到要编辑的图片
2. 点击图片下方的"用作输入"按钮
3. 系统会自动跳转到增强器页面
4. 图片会被加载到输入区域
5. 选择效果并生成

---

## ⚙️ 设置和配置

### Q: 如何提升生成速度？

**A:** 

1. **减少生成数量**
   - 在设置中将生成数量设为 1

2. **使用较小图片**
   - 上传前压缩图片大小
   - 推荐分辨率：1024x1024

3. **简化提示词**
   - 避免过于复杂的描述
   - 关闭 AI 预处理

4. **减少重试次数**
   - 在设置中将重试次数设为 0 或 1

### Q: 如何节省 API 配额？

**A:** 

1. **精心设计提示词**
   - 一次生成成功，减少重试
   - 使用明确、具体的描述

2. **使用批量生成**
   - 一次生成多张，选择最好的
   - 避免多次单张生成

3. **复用生成结果**
   - 使用资产库管理图片
   - 链式编辑，叠加多个效果

4. **监控配额使用**
   - 定期查看 Google AI Studio 的配额
   - 合理安排使用时间

### Q: 进阶模式有什么用？

**A:** 

**开启方法**：连续点击应用标题 5 次

**功能**：
- 禁用水印（生成的图片不会有水印）
- 显示更多调试信息
- 访问实验性功能

**注意**：
- 仅用于开发和测试
- 生成的图片没有版权保护
- 可能包含不稳定的功能

---

## 🌐 部署和访问

### Q: 如何在手机上访问？

**A:** 

**方法 1：局域网访问**
1. 确保手机和电脑在同一 WiFi 网络
2. 启动开发服务器后，查看 Network 地址
3. 在手机浏览器中访问该地址（如 `http://192.168.x.x:3000`）

**方法 2：部署到服务器**
1. 构建生产版本：`npm run build`
2. 部署到 Vercel、Netlify 等平台
3. 通过域名访问

### Q: 如何部署到生产环境？

**A:** 

**构建生产版本**：
```bash
npm run build
```

**预览生产版本**：
```bash
npm run preview
```

**部署选项**：
1. **Vercel**（推荐）
   - 连接 GitHub 仓库
   - 自动部署
   - 免费 HTTPS

2. **Netlify**
   - 拖拽 `dist` 文件夹
   - 或连接 Git 仓库

3. **GitHub Pages**
   - 需要配置 base path
   - 适合静态托管

4. **自己的服务器**
   - 上传 `dist` 文件夹
   - 配置 Nginx 或 Apache

**注意**：
- 确保在生产环境配置 API 密钥
- 使用环境变量，不要硬编码
- 考虑使用后端代理保护 API 密钥

---

## 🐛 错误信息解读

### "请求被阻止" / "SAFETY"

**原因**：内容触发了 Google 的安全过滤

**解决**：
- 修改提示词，避免敏感内容
- 使用更中性、更具体的描述
- 如果是误判，可以尝试换个说法

### "配额用尽" / "RESOURCE_EXHAUSTED"

**原因**：API 调用次数超出限制

**解决**：
- 等待配额重置（通常每分钟或每天）
- 访问 Google AI Studio 查看配额
- 考虑升级到付费计划

### "网络错误" / "Failed to fetch"

**原因**：无法连接到 Google API

**解决**：
- 检查网络连接
- 检查防火墙设置
- 尝试使用 VPN（如果在某些地区）
- 确认 Google 服务是否正常

### "模型没有返回图片或文本"

**原因**：AI 拒绝了请求或生成失败

**解决**：
- 修改提示词
- 检查输入图片是否有效
- 尝试使用不同的效果
- 增加重试次数

---

## 💡 使用技巧

### Q: 如何获得最佳效果？

**A:** 

1. **选择合适的效果**
   - 根据图片类型选择效果
   - 人像照片 → 时尚杂志、Cosplay
   - 风景照片 → 艺术效果、双重曝光
   - 产品照片 → 产品渲染、高清增强

2. **优化输入图片**
   - 使用高分辨率图片
   - 确保主体清晰
   - 避免过度压缩

3. **精心设计提示词**
   - 具体描述想要的效果
   - 添加风格、氛围、光线等细节
   - 参考成功的案例

4. **链式编辑**
   - 先用高清增强提升质量
   - 再应用艺术效果
   - 最后添加特殊元素

### Q: 如何快速找到想要的效果？

**A:** 

1. **使用分类浏览**
   - 病毒式传播：社交媒体效果
   - 照片处理：专业编辑
   - 设计工具：设计师工具
   - 实用工具：多功能工具
   - 艺术效果：艺术风格

2. **使用搜索功能**
   - 输入关键词搜索效果
   - AI 会推荐相关效果

3. **收藏常用效果**
   - 记住常用效果的位置
   - 或使用浏览器书签

---

## 📞 获取帮助

如果以上内容没有解决你的问题：

1. **查看浏览器控制台**
   - 按 F12 打开开发者工具
   - 查看 Console 标签的错误信息
   - 截图保存错误详情

2. **查看其他文档**
   - [快速开始指南](./快速开始指南.md)
   - [功能详解](./功能详解.md)
   - [开发文档](./开发文档.md)

3. **提交 Issue**
   - 访问 [GitHub Issues](https://github.com/ameureka/nano-bananary-playground/issues)
   - 描述问题和复现步骤
   - 附上错误截图和日志

4. **查看 Google AI Studio**
   - 访问 [Google AI Studio](https://aistudio.google.com/)
   - 查看 API 状态和配额
   - 阅读官方文档

---

**文档版本**：v1.0  
**最后更新**：2025-10-27
