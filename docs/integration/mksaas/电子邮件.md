好的，这是对您提供的最后一个文档“电子邮件”的完整 Markdown 格式转换。所有内容，包括标题、文本、代码块、结构，以及对所有图片的识别和描述，都已包含在内。至此，您提供的所有文档都已转换完毕。

***

### 文件 22：电子邮件 (Email)

<+> MkSaaS 文档
Π
Q 搜索文档
*   **主页**
*   **介绍**
*   <> 代码库
*   **视频教程**
*   **入门**
*   <> 环境设置
*   **配置**
*   **部署**
*   **集成**
    *   数据库
    *   验证
    *   **电子邮件**
    *   通讯
    *   贮存
    *   支付
    *   致谢
    *   ① 计划任务
    *   人工智能
    *   分析
    *   通知
    *   ○ 验证码
    *   聊天框
    *   关联公司
*   **定制**
    *   目元数据
    *   T字体
    *   主题
    *   图片
    *   国际化
    *   博客
    *   文档
*   **成分**
    *   ● 自定义页面
    *   登陆页面
    *   用户管理
*   **代码库**
    *   IDE 设置
    *   品项目结构
    *   A格式化和 Linting
    *   更新代码库

---

### 电子邮件

了解如何通过“重新发送”和“反应电子邮件”模板设置和使用电子邮件功能。

MkSaaS 使用 **Resend** 发送电子邮件，并使用 **React Email** 创建精美的电子邮件模板。这种组合提供了一种现代化且开发者友好的方式来处理应用程序中的电子邮件通信。

#### 设置

1.  在 `resend.com` 创建 Resend 帐户。
2.  在仪表板中单击 **API Keys > Create API Key**，将权限设置为 `Send emails` 或 `Full access`。
3.  获取 API 密钥，并将其添加到 `.env` 文件：
    `.env`
    ```
    RESEND_API_KEY=re_...
    ```
4.  更新 `website.tsx` 文件以使用 Resend 作为电子邮件提供商，并设置默认发件人电子邮件地址：

    > **请注意**，`fromEmail` 是默认发件人电子邮件地址，电子邮件地址后缀是您的电子邮件域。

    `src/config/website.tsx`
    ```tsx
    export const websiteConfig = {
      // ...other config
      mail: {
        provider: 'resend', // Email provider to use
        fromEmail: 'contact@example.com', // Default sender email address
      },
      // ...other config
    }
    ```
> ▲ 如果您正在设置环境，现在可以返回**环境设置指南**并继续。本指南的其余部分可以稍后阅读。
>
> **<> 环境设置**
> 设置环境变量

#### 电子邮件体系结构

MkSaaS 中的电子邮件系统设计有以下组件：

*   **源码 (src)**
    *   `邮件 (mail)`
        *   `提供者 (provider)`
        *   `模板 (templates)`
        *   `成分 (components)`
        *   `索引.ts`
        *   `类型.ts`
        *   `自述文件.md`

这种模块化结构使得使用新的提供程序、模板和组件来扩展电子邮件系统变得很容易。

#### 核心功能

*   带有“重新发送”集成的事务性电子邮件发送
*   使用 React Email 构建的精美电子邮件模板
*   预先构建的验证、密码重置和联系表单模板
*   多语言电子邮件模板的国际化支持
*   可重复使用的电子邮件组件（布局、按钮等）
*   模块化架构，方便切换供应商
*   邮件预览和测试的开发者工具，支持本地预览和测试

#### 用法

MkSaaS 提供了一个简单的电子邮件发送界面，支持基于模板的电子邮件和原始内容：
```ts
import { sendEmail } from '@/mail';

// Send email using a template
await sendEmail({
  to: 'user@example.com',
  template: 'verifyEmail',
  context: {
    name: 'John Doe',
    url: 'https://example.com/verify?token=abc123',
  },
  locale: 'en', // Optional, defaults to config default locale
});

// Send raw email
await sendEmail({
  to: 'user@example.com',
  subject: 'Welcome to our platform',
  html: '<h1>Hello!</h1><p>Welcome to our platform.</p>',
  text: 'Hello! Welcome to our platform.', // Optional
});
```

#### 电子邮件模板

MkSaaS 包含几个针对不同用例的预建电子邮件模板：

*   **验证电子邮件.tsx**
    用于用户注册时或更改电子邮件地址时的电子邮件验证。
    ```ts
    await sendEmail({
      to: 'user@example.com',
      template: 'verifyEmail',
      context: {
        name: 'John Doe',
        url: 'https://example.com/verify?token=abc123',
      },
    });
    ```
*   **忘记密码.tsx**
*   **订阅新闻通讯.tsx**
*   **联系信息.tsx**

#### 电子邮件组件

MkSaaS 在 `src/mail/components` 目录中包含可重复使用的电子邮件组件，以帮助构建一致的电子邮件模板：

*   **电子邮件布局.tsx**
*   **电子邮件按钮.tsx**

#### 预览电子邮件

MkSaaS 提供了预览电子邮件功能，可让您在发送电子邮件之前预览：
```bash
pnpm run email
```
这将启动一个本地服务器，允许您在浏览器中预览电子邮件。

![图片描述：React Email 的预览界面。左侧边栏列出了可用的邮件模板（如 contact-message, forgot-password 等），右侧主区域展示了“verify-email”模板的视觉效果，包含标题、正文和一个“Confirm email”按钮。](https://storage.googleapis.com/agent-tools-public-mde/1723153835561-1.png)

#### 定制

##### 创建自定义模板

1.  在 `src/mail/templates` 目录中创建一个 React 组件作为电子邮件模板：

    `src/mail/templates/my-custom-email.tsx`
    ```tsx
    import { BaseEmailProps } from '@/mail/types';
    import { EmailLayout } from '../components/email-layout';
    import { EmailButton } from '../components/email-button';

    interface MyCustomEmailProps extends BaseEmailProps {
      username: string;
      actionUrl: string;
    }

    export function MyCustomEmail({
      username,
      actionUrl,
      messages,
      locale
    }: MyCustomEmailProps) {
      return (
        <EmailLayout>
          <p>Hello {username}!</p>
          <p>Thanks for joining our platform. Click the button below to get started.</p>
          <EmailButton href={actionUrl}>Get Started</EmailButton>
        </EmailLayout>
      );
    }
    ```
2.  更新 `types.ts` 中的 `EmailTemplates` 接口以包含新的电子邮件模板：

    `src/邮件/types.ts`
    ```ts
    export interface EmailTemplates {
      // ... existing templates
      myCustomEmail: MyCustomEmail;
    }
    ```
3.  如果需要，请在您的 i18n 消息中添加相应的主题翻译。
4.  在本地预览您的模板：
    ```bash
    pnpm run email
    ```
5.  在您的代码中使用模板：
    ```ts
    await sendEmail({
      to: 'user@example.com',
      template: 'myCustomEmail',
      context: {
        username: 'John',
        actionUrl: 'https://example.com/start',
      },
    });
    ```

##### 创建新的电子邮件提供商

MkSaaS 可以轻松地通过新提供商扩展电子邮件系统：

1.  在 `src/mail/provider` 目录中创建一个新文件。
2.  从 `types.ts` 实现 `MailProvider` 接口。
3.  更新 `index.ts` 中的提供商选择逻辑。

新提供商的示例实现：

`src/mail/provider/my-provider.ts`
```ts
import { MailProvider, SendEmailResult, SendRawEmailParams, SendTemplateParams } from '@/mail/types';

export class MyProvider implements MailProvider {
  constructor() {
    // Initialize your provider
  }

  public async sendTemplate(params: SendTemplateParams): Promise<SendEmailResult> {
    // Implementation for sending template emails
  }

  public async sendRawEmail(params: SendRawEmailParams): Promise<SendEmailResult> {
    // Implementation for sending raw emails
  }

  public getProviderName(): string {
    return 'my-provider';
  }
}
```
然后在 `index.ts` 中更新提供商选择：

`src/邮件/index.ts`
```ts
import { MyProvider } from './provider/my-provider';

export const initializeMailProvider = (): MailProvider => {
  if (!mailProvider) {
    if (websiteConfig.mail.provider === 'resend') {
      mailProvider = new ResendProvider();
    } else if (websiteConfig.mail.provider === 'custom') {
      mailProvider = new CustomMailProvider(); // Assuming CustomMailProvider is your class
    } else {
      throw new Error(
        `Unsupported mail provider: ${websiteConfig.mail.provider}`
      );
    }
  }
  return mailProvider;
};```

#### 视频教程

<br>
![图片描述：一个视频教程的缩略图，标题为“MkSaaS模板 配置和部署教程”，副标题为“从拉取代码到部署上线的全流程实录”。画面中有一个火箭图标，象征着部署和启动。](https://storage.googleapis.com/agent-tools-public-mde/1723149495094-2.png)> [在 YouTube 上观看：MkSaaS 模板的网站配置和部署教程](https://www.youtube.com/watch?v=placeholder)
<br>
![图片描述：一个视频教程的缩略图，标题为“MkSaaS模板 其他功能的配置和使用”，副标题为“集成统计分析、联盟营销、企业邮箱等”。画面中有一个显示图表的画板。](https://storage.googleapis.com/agent-tools-public-mde/1723146430335-1.png)
> [在 YouTube 上观看：MkSaaS 模板的其他功能配置教程](https://www.youtube.com/watch?v=placeholder)
<br>

#### 后续步骤

现在您了解了如何在 MkSaaS 中处理电子邮件，您可能想要探索这些相关功能：

| | |
| :--- | :--- |
| **数据库**<br>配置数据库 | **验证**<br>配置用户身份验证 |
| **通讯**<br>配置新闻稿 | **环境设置**<br>配置环境变量 |

< **验证**
了解如何在 MkSaaS 中使用 Better Auth 设置和使用身份...

**通讯 >**
了解如何设置和使用“重新发送”功能进行新闻通讯管理