好的，这是对您提供的最后一个文档“通讯”的完整 Markdown 格式转换。所有内容，包括标题、文本、代码块、结构，以及对所有图片的识别和描述，都已包含在内。至此，您提供的所有文档都已转换完毕。

***

### 文件 32：通讯 (Newsletter)

<+> MkSaaS 文档
Π
Q 搜索文档
*   **主页**
*   **介绍**
*   <> 代码库
*   **视频教程**
*   **入门**
*   <> 环境设置
*   **配置**
*   **部署**
*   **集成**
    *   数据库
    *   验证
    *   电子邮件
    *   **通讯**
    *   贮存
    *   支付
    *   致谢
    *   ① 计划任务
    *   人工智能
    *   分析
    *   通知
    *   ○ 验证码
    *   聊天框
    *   关联公司
*   **定制**
    *   目元数据
    *   T字体
    *   主题
    *   图片
    *   国际化
    *   博客
    *   文档
*   **成分**
    *   ● 自定义页面
    *   登陆页面
    *   用户管理
*   **代码库**
    *   IDE 设置
    *   品项目结构
    *   A格式化和 Linting
    *   更新代码库

---

### 通讯

了解如何设置和使用“重新发送”功能进行新闻通讯管理。

MkSaaS 使用 **Resend** 进行新闻通讯管理。此集成功能提供了一种简单而强大的方法来管理用户的新闻通讯订阅。

#### 设置

1.  在 `resend.com` 创建 Resend 帐户。
2.  在仪表板中单击 **API Keys > Create API Key**，将权限设置为 `Send emails` 或 `Full access`。
3.  在仪表板中为新闻通讯订阅者创建 **Audience**（或使用默认受众）（在 API 视图中获取 Audience ID）。
4.  从仪表板获取 API key 和 Audience ID，并将它们添加到 `.env` 文件中：

    `.env`
    ```
    RESEND_API_KEY=re_...
    RESEND_AUDIENCE_ID=your_audience_id
    ```
5.  更新网站配置以使用“重新发送”进行新闻通讯管理：

    `src/config/website.tsx`
    ```tsx
    export const websiteConfig = {
      // ...other config
      newsletter: {
        provider: 'resend', // Newsletter service provider to use
        autoSubscribeAfterSignUp: false, // Whether to automatically subscribe users after sign up
      },
      // ...other config
    }
    ```
> ▲ 如果您正在设置环境，现在可以返回**环境设置指南**并继续。本指南的其余部分可以稍后阅读。
>
> **<> 环境设置**
> 设置环境变量

#### 简报系统结构

MkSaaS 中的新闻通讯系统设计有以下组件：

*   **源码 (src)**
    *   `通讯 (newsletter)`
        *   `提供者 (provider)`
        *   `重新发送.ts (resend.ts)`
        *   `索引.ts`
        *   `类型.ts`
        *   `自述文件.md`

这种模块化结构使得在需要时可以轻松地通过新的提供商扩展新闻通讯系统。

#### 核心功能

*   新闻通讯订阅和取消订阅管理
*   重新发送用户订阅列表的受众整合信息
*   用户订阅状态检查
*   新用户可选自动订阅
*   模块化架构，方便切换新闻通讯服务提供商

#### 用法

##### 基本用法

MkSaaS 为新闻通讯管理提供了简单的实用功能。
```ts
import { subscribe, unsubscribe, isSubscribed } from '@/newsletter';

// Subscribe a user to the newsletter
const success = await subscribe('user@example.com');

// Unsubscribe a user from the newsletter
const success = await unsubscribe('user@example.com');

// Check if a user is subscribed
const subscribed = await isSubscribed('user@example.com');
```

##### 与电子邮件模板一起使用

您可以将新闻稿功能与电子邮件系统结合起来发送确认电子邮件：
```ts
import { subscribe } from '@/newsletter';
import { sendEmail } from '@/mail';

export async function subscribeWithConfirmation(email: string) {
  // Subscribe the user to the newsletter
  const success = await subscribe(email);

  if (success) {
    // Send a confirmation email to the user
    await sendEmail({
      to: email,
      template: 'subscribeNewsletter',
      context: {
        name: email.split('@')[0], // Simple name extraction
        unsubscribeUrl: `https://example.com/unsubscribe?email=${encodeURIComponent(email)}`,
      },
    });
  }

  return success;
}
```

#### 定制

##### 创建自定义提供程序

如果您需要使用不同的新闻通讯服务，您可以创建自定义提供程序：

1.  在 `src/newsletter/provider` 目录中创建一个新文件作为自定义新闻通讯服务提供商。
2.  实现 `NewsletterProvider` 接口。

    `src/newsletter/provider/custom-provider.ts`
    ```ts
    import type {
      CheckSubscribeStatusParams,
      NewsletterProvider,
      SubscribeNewsletterParams,
      UnsubscribeNewsletterParams,
    } from '@/newsletter/types';

    export class CustomNewsletterProvider implements NewsletterProvider {
      constructor() {
        // Initialize your provider
      }

      public getProviderName(): string {
        return 'CustomProvider';
      }

      async subscribe({ email }: SubscribeNewsletterParams): Promise<boolean> {
        // Implementation for subscribing a user
        return true;
      }

      async unsubscribe({ email }: UnsubscribeNewsletterParams): Promise<boolean> {
        // Implementation for unsubscribing a user
        return true;
      }
      
      async checkSubscribeStatus({ email }: CheckSubscribeStatusParams): Promise<boolean> {
        // Implementation for checking subscription status
        return true;
      }
    }
    ```
3.  更新 `index.ts` 中的提供商选择逻辑：

    `src/newsletter/index.ts`
    ```ts
    import { CustomNewsletterProvider } from './provider/custom-provider';

    export const initializeNewsletterProvider = (): NewsletterProvider => {
      if (!newsletterProvider) {
        if (websiteConfig.newsletter.provider === 'resend') {
          newsletterProvider = new ResendProvider();
        } else if (websiteConfig.newsletter.provider === 'custom') {
          newsletterProvider = new CustomNewsletterProvider();
        } else {
          throw new Error(
            `Unsupported newsletter provider: ${websiteConfig.newsletter.provider}`
          );
        }
      }
      return newsletterProvider;
    };
    ```

#### 最佳实践

1.  **验证电子邮件地址**：订阅用户之前务必验证电子邮件地址。
2.  **确认电子邮件**：当用户订阅新闻通讯时发送确认电子邮件。
3.  **取消订阅链接**：始终在您的新闻通讯电子邮件中包含取消订阅链接。
4.  **隐私政策**：确保您的网站有隐私政策，解释如何使用用户订阅的数据。

#### 视频教程

<br>
![图片描述：一个视频教程的缩略图，标题为“MkSaaS模板 配置和部署教程”，副标题为“从拉取代码到部署上线的全流程实录”。画面中有一个火箭图标，象征着部署和启动。](https://storage.googleapis.com/agent-tools-public-mde/1723149495094-2.png)
> [在 YouTube 上观看：MkSaaS 模板的网站配置和部署教程](https://www.youtube.com/watch?v=placeholder)
<br>
![图片描述：一个视频教程的缩略图，标题为“MkSaaS模板 其他功能的配置和使用”，副标题为“集成统计分析、联盟营销、企业邮箱等”。画面中有一个显示图表的画板。](https://storage.googleapis.com/agent-tools-public-mde/1723146430335-1.png)
> [在 YouTube 上观看：MkSaaS 模板的其他功能配置教程](https://www.youtube.com/watch?v=placeholder)
<br>

#### 后续步骤

现在您已经了解了如何在 MkSaaS 中使用新闻通讯，请探索以下相关集成：

| | |
| :--- | :--- |
| **电子邮件**<br>配置电子邮件服务 | **验证**<br>配置用户身份验证 |
| **分析**<br>配置分析 | **贮存**<br>配置存储 |

< **电子邮件**
了解如何通过“重新发送”和“反应电子邮件”模板设置和使...

**贮存 >**
了解如何设置和使用云存储进行文件上传和媒体处理