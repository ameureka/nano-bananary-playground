好的，这是对您提供的最后一个文档“通知”的完整 Markdown 格式转换。所有内容，包括标题、文本、代码块、结构，以及对所有图片的识别和描述，都已包含在内。至此，您提供的所有文档都已转换完毕。

***

### 文件 31：通知 (Notifications)

<+> MkSaaS 文档
Π
Q 搜索文档
*   **主页**
*   **介绍**
*   <> 代码库
*   **视频教程**
*   **入门**
*   <> 环境设置
*   **配置**
*   **部署**
*   **集成**
    *   数据库
    *   验证
    *   电子邮件
    *   通讯
    *   贮存
    *   支付
    *   致谢
    *   ① 计划任务
    *   人工智能
    *   分析
    *   **通知**
    *   ○ 验证码
    *   聊天框
    *   关联公司
*   **定制**
    *   目元数据
    *   T字体
    *   主题
    *   图片
    *   国际化
    *   博客
    *   文档
*   **成分**
    *   ● 自定义页面
    *   登陆页面
    *   用户管理
*   **代码库**
    *   IDE 设置
    *   品项目结构
    *   A格式化和 Linting
    *   更新代码库

---

### 通知

了解如何在 MkSaaS 中设置和使用通知。

MkSaaS 支持在用户成功完成付款时发送通知。这使您的团队能够在常用工具中接收实时购买提醒。目前，我们支持 **Discord** 和 **飞书**。未来将支持更多通知渠道（例如 Telegram）。模块化设计让您能够根据需要轻松集成其他服务。

#### 设置

要启用通知，您需要在 `.env` 文件中配置以下环境变量：

`.env`
```
DISCORD_WEBHOOK_URL="https://discord.com/api/webhooks/..."
FEISHU_WEBHOOK_URL="https://open.feishu.cn/open-apis/bot/v2/hook/..."
```

##### 不和谐 (Discord)

1.  转到您的 Discord 服务器并打开您想要接收通知的频道。
2.  单击齿轮图标打开 **Channel Settings**。
3.  选择 **Integrations > Webhooks > New Webhook**。
4.  为 Webhook 设置名称和（可选）头像。
5.  复制 Webhook URL 并将其粘贴到您的 `.env` 文件中作为 `DISCORD_WEBHOOK_URL`。

有关更多详细信息，请参阅 [Discord Webhooks 指南](https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks)。

##### 飞书

1.  进入飞书群聊。
2.  单击组名 > **Group Settings > Bot Management**。
3.  添加新的 **Custom Bot** 并启用 Webhooks。
4.  复制生成的 Webhook URL 并将其粘贴到您的 `.env` 文件中作为 `FEISHU_WEBHOOK_URL`。

更多详细信息，请参阅[飞书 Webhook 文档](https://open.feishu.cn/document/ukTMukTMukTM/ucTM5YjL3ETO24yNxUjN)。

> ▲ 如果您正在设置环境，现在可以返回**环境设置指南**并继续。本指南的其余部分可以稍后阅读。
>
> **<> 环境设置**
> 设置环境变量

#### 通知系统结构

MkSaaS 中的通知系统是模块化的，易于扩展：

*   **源码 (src)**
    *   `通知 (notification)`
        *   `discord.ts`
        *   `飞书.ts`
        *   `通知.ts`

*   `discord.ts`: 向 Discord 发送购买通知。
*   `feishu.ts`: 向飞书发送购买通知。
*   `notification.ts`: 向所有启用的渠道发送通知的中央入口点。

#### 核心功能

*   付款成功实时通知
*   开箱即用，支持 Discord 和 Feishu
*   轻松添加更多通知渠道

#### 用法

要在付款成功后发送通知，请使用以下实用程序：
```ts
import { sendNotification } from '@/notification';

// Example usage after payment success
await sendNotification(sessionId, customerId, userName, amount);
```

#### 消息格式

通知消息包含以下信息：

*   **用户名**：客户的用户名
*   **金额**：购买金额（美元）
*   **客户 ID**：Stripe 客户 ID，供参考
*   **会话 ID**：用于跟踪的 Stripe 结账会话 ID
*   **时间戳**：购买发生的时间

##### Discord 消息

Discord 通知以绿色消息和结构化字段的形式发送，以便于阅读。

![图片描述：Discord 频道中的付款成功通知。每条通知都由一个机器人（如 IndieHub Bot）发送，以嵌入式消息的形式清晰地列出了新购买的用户名、金额、客户ID和会话ID。](https://storage.googleapis.com/agent-tools-public-mde/1723155162464-1.png)

##### 飞书留言

飞书通知以纯文本消息的形式发送，所有购买信息格式清晰。

![图片描述：飞书群聊中的付款成功通知。每条通知都由一个机器人（MkSaaS Bot）发送，以文本消息的形式列出了新购买的用户名、金额、客户ID和会话ID。](https://storage.googleapis.com/agent-tools-public-mde/1723155162464-2.png)

#### 定制和可扩展性

通知系统设计为可扩展的。要添加新的通知渠道，请执行以下操作：

1.  在 `src/notification` 目录中创建一个新文件（例如，`slack.ts`）。
2.  实现一个向新频道发送消息的函数：

    `src/通知/slack.ts`
    ```ts
    export async function sendMessageToSlack(
      sessionId: string,
      customerId: string,
      userName: string,
      amount: number
    ): Promise<void> {
      try {
        const webhookUrl = process.env.SLACK_WEBHOOK_URL;

        if (!webhookUrl) {
          console.warn('SLACK_WEBHOOK_URL is not set, skipping Slack notification');
          return;
        }

        // Your Slack message implementation
        
      } catch (error) {
        console.error('<< Failed to send Slack notification:', error);
      }
    }
    ```
3.  在 `notification.ts` 中导入并调用此函数：

    `src/通知/notification.ts`
    ```ts
    import { sendMessageToSlack } from './slack';

    export async function sendNotification(
      sessionId: string,
      customerId: string,
      userName: string,
      amount: number
    ): Promise<void> {
      // Existing Discord and Feishu calls
      await sendMessageToDiscord(sessionId, customerId, userName, amount);
      await sendMessageToFeishu(sessionId, customerId, userName, amount);

      // Add new Slack notification
      await sendMessageToSlack(sessionId, customerId, userName, amount);
    }
    ```

#### 最佳实践

1.  **保持 Webhook URL 的秘密**：切勿公开您的 webhook URL 或将其提交到版本控制。
2.  **监控传递**：检查您的通知渠道以确保消息按预期传递。
3.  **错误处理**：如果通知失败，系统会记录错误，但不会中断支付流程。
4.  **速率限制**：注意每个服务的 webhook 速率限制，以避免被阻止。
5.  **测试**：在部署到生产环境之前，在开发环境中测试您的 webhook。

#### 视频教程

<br>
![图片描述：一个视频教程的缩略图，标题为“MkSaaS模板 其他功能的配置和使用”，副标题为“集成统计分析、联盟营销、企业邮箱等”。画面中有一个显示图表的画板。](https://storage.googleapis.com/agent-tools-public-mde/1723146430335-1.png)
> [在 YouTube 上观看：MkSaaS 模板的其他功能配置教程](https://www.youtube.com/watch?v=placeholder)
<br>

#### 后续步骤

现在您了解了如何在 MkSaaS 中使用通知，请探索这些相关的集成：

| | |
| :--- | :--- |
| **电子邮件**<br>配置电子邮件服务 | **验证**<br>配置用户身份验证 |
| **分析**<br>配置分析 | **贮存**<br>配置存储 |

< **分析**
了解如何在 MkSaaS 网站中设置和使用各种分析工具

**验证码 >**
了解如何在 MkSaaS 中设置和使用验证码